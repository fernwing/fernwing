extends layout
mixin order-choice(color)
  .choice(ng-class="{'soldout':!avail."+color+"}"): .ib
    .price
      span(ng-show="!count."+color) 每個 
      span {{price.#{color}}} 元
      span(ng-show="count."+color)  x {{count.#{color}}} = {{price.#{color} * count.#{color}}} 元
    .color(class=color)
    select.form-control(class=color,ng-disabled="!avail."+color,name="count_"+color,ng-model="count."+color,ng-options="v for v in choicelist['"+color+"']")
      option(value="0") 0
block pre-content
  #dim.dimmer(ng-show="state==1"): .ib 處理訂單中 .. 
  #feathers
block bare-content
  #banner
    #banner-bk.delay-bk(delay-bk="/img/banner/bk1400-blur.jpg")
    #banner-logo.delay-bk(delay-bk="/img/logo/main.png")
    #banner-logo-sm.delay-bk(delay-bk="/img/logo/main-sm.png")
    #banner-logo-xs.delay-bk(delay-bk="/img/logo/white.png")
    #banner-subtitle 為愛好休閒生活的您量身打造，輕巧、舒適、高機能性的隨身背包
    a#banner-golook(href="/#gallery")
      .desc 現在就來瞧瞧他的外觀
      i.glyphicon.glyphicon-chevron-down
  #content
    #gallery
      .brick.two.delay-bk(delay-bk="/img/gallery/01.jpg")
      .brick-group.one
        .brick.one.half.delay-bk(delay-bk="/img/gallery/10.jpg",style="margin-bottom:2px")
        .brick.one.half.delay-bk(delay-bk="/img/gallery/06.jpg",style="margin-bottom:2px")
      .brick.one.delay-bk(delay-bk="/img/gallery/04.jpg")
      .brick.one.vg4.vg5.vg6.vg7.vg8.delay-bk(delay-bk="/img/gallery/05.jpg")
      .brick.two.vg4.delay-bk(delay-bk="/img/gallery/12.jpg")
      .brick.one.delay-bk(delay-bk="/img/gallery/09.jpg")
      .brick.one.vg3.vg4.vg5.vg6.vg7.vg8.delay-bk(delay-bk="/img/gallery/08.jpg")
      .brick-group.one.vg1
        .brick.one.half.delay-bk(delay-bk="/img/gallery/10.jpg",style="margin-bottom:2px")
        .brick.one.half.delay-bk(delay-bk="/img/gallery/06.jpg",style="margin-bottom:2px")
      .brick.two.vg6.delay-bk(delay-bk="/img/gallery/12.jpg")
      .brick.one.delay-bk(delay-bk="/img/gallery/07.jpg")
      .brick.two.delay-bk(delay-bk="/img/gallery/03.jpg")
      br.clear
    #gallery-xs
      img(src="/img/gallery/320/01.jpg")
      img(src="/img/gallery/320/07.jpg")
      //-img(src="/img/gallery/320/02.jpg")
      img(src="/img/gallery/320/06.jpg")
      //-img(src="/img/gallery/320/04.jpg")
      img(src="/img/gallery/320/05.jpg")
    br.clear
    br.clear
  a(name="brief")
  div
    #content
      #feature
        div.text-center
          a.btn.btn-danger.btn-lg#order-now(href="#order-info") 心動了嗎？點我訂購
        //.wing.delay-bk#wing-feature.hidden-xs(delay-bk="/img/wing-white.png")
        h2 
          span 三個特色，
          br.visible-xs
          span 滿足您對背包的期待與渴望
        br
        .row
          .col-sm-4.bl-red
            .feature
              .feature-icon.delay-bk(delay-bk="/img/feature/a.png")
              .feature-icon.delay-bk(delay-bk="/img/feature/a-2.png")
            h3#feature-trilogy 極舒適
            p.visible-xs
              | 一般輕量背包常在背負系統妥協而影響舒適性，但是
              b 蕨之翼
              | 在輕量化時仍使用
              b 透氣可調式肩帶
              | ，讓你即使日常使用也不會有額外負擔。
            p.hidden-xs 
              | 一般輕量化背包為了減少重量會在背負系統妥協而影響舒適性，然而
              b 蕨休閒背包
              | 在輕量化的同時仍使用
              b 透氣可調式肩帶
              | ，良好的背負系統讓你即使在日常生活中使用它也不會有額外的負擔。
          .col-sm-4.bl-green
            .feature
              .feature-icon.delay-bk(delay-bk="/img/feature/b.png")
              .feature-icon.delay-bk(delay-bk="/img/feature/b-2.png")
            h3 超輕量
            p.visible-xs
              | 僅
              b  300 公克
              | - 比一盒
              b  鋁箔包
              |  還輕，收納後就如手掌大，節省家中空間與行李箱容量，無論旅遊、通勤、甚至上賣場，沒有理由不將他帶上。
            p.hidden-xs 
              | 重量不到
              b 300 克
              | ，甚至比一盒
              b 鋁箔包飲料
              | 還輕。收納後大約
              b 一個手掌大
              | ，節省家中儲藏空間，也節省登山背包的珍貴容量，無論登山、旅遊、通勤、甚至上賣場，你沒有理由不隨身帶上一個。
          .col-sm-4.bl-cyan
            .feature
              .feature-icon.delay-bk(delay-bk="/img/feature/c.png")
              .feature-icon.delay-bk(delay-bk="/img/feature/c-2.png")
            h3 高機能性
            p.visible-xs
              | 在輕量化的同時仍保有
              b 雙側袋
              | 、
              b 前袋
              | 以及
              b 拉鏈帶
              | ，讓您輕易就找到東西放在哪，現在就把其他機能不良的背包丟了吧。
            p.hidden-xs
              | 輕量化的同時仍保有
              b 雙側袋
              | 、
              b 前袋
              | 以及
              b 拉鏈帶
              | ，妥善的分隔讓你瞬間就能找到東西。水壺雨具在側邊、錢包零錢在前袋，甚至
              b 不需卸下背包
              | 就能取得，現在就把其他機能不良的背包丟了吧。
      .wing.delay-bk.hidden-xs(delay-bk="/img/wing-white.png")
      h4.text-center: b 更多特色
      br
      #detail
        .item
          .img.delay-bk(delay-bk="/img/detail/08.jpg")
          .title 收納後輕便的體積重量
        .item
          .img.delay-bk(delay-bk="/img/detail/04.jpg")
          .title 透氣且排汗的背包背帶
        .item
          .img.delay-bk(delay-bk="/img/detail/02.jpg")
          .title 方便的側袋與前袋隔間
        .item.hidden-xs
          .img.delay-bk(delay-bk="/img/detail/06.jpg")
          .title 背帶可以迅速調整長度
        .item.hidden-xs
          .img.delay-bk(delay-bk="/img/detail/05.jpg")
          .title 易拉的拉鏈並附有拉帶
        .item
          .img.delay-bk(delay-bk="/img/detail/03.jpg")
          .title 增添設計感的背包花紋
        .item.w480
          .img.delay-bk(delay-bk="/img/detail/07.jpg")
          .title 適合各式各樣場合使用
        .item.w1260
          .img.delay-bk(delay-bk="/img/detail/09.jpg")
          .title 多種顏色款式可供選擇

        .item#spec
          .desc: .ib
            h3
              | 產品規格
              small  / 蕨之翼隨身背包
            ul
              li 容量: 25升
              li 
                | 重量: 
                b 199公克
                | ，三顆蛋的重量
            ul
              li 尺寸: 高 36 / 寬 24 / 深 14 (公分)
              li 收納後: 長 19 / 寬 17 (公分)

      br.clear
      br
      #order-info
      hr.hidden-xs
      #notify.shown(ng-show="status.status!=1"): div(ng-controller="notify")
        .ib
          h1.text-center 訂購資訊
          br
          h2 還沒開賣，有興趣嗎？請留下 email 讓我們通知您
          br
          br
        form.form-inline.text-center(name="notifyform",novalidate)
          .form-group(ng-class="fix('email')")
            +valid-label("notifyform","email", "電子郵件信箱", "電子郵件信箱")
            input.form-control.input-lg(type="email",placeholder="例如：john@mail.tw",
              ng-disabled="state!=0",name="email",ng-model="email",required)
          .btn.btn-danger.btn-lg(ng-click="submit()",style="vertical-align:bottom",ng-disabled="state!=0") 送出
        br
        h2(ng-show="state==1")
          ldstate(ng-model="status.value")
        h2(ng-show="state==2") 感謝您的回饋！
      #order.shown(ng-show="status.status==1")
        .ib
          h2 
            i.glyphicon.glyphicon-phone-alt
            |  現在就訂購！
          .text-center 蕨之翼採貨到付款，安全有保障
          br

          form(name="orderform",novalidate)
            h4
              i.glyphicon.glyphicon-shopping-cart
              |  第一步、選擇數量
            .choices

              +order-choice("red")
              +order-choice("green")
              +order-choice("cyan")
              +order-choice("purple")
              +order-choice("magenta")
              +order-choice("black")

            br.clear
            br
            h4#ship-info
              i.glyphicon.glyphicon-list-alt
              |  第二步、運送資訊
            br
            .form-group(ng-class="fix('name')")
              +valid-label("orderform","name", "收件人", "姓名")
              input.form-control(type="text",placeholder="例如： 王永仁",
                ng-disabled="!want || state!=0",name="name",ng-model="name",required,ng-minlength="2")
            .form-group(ng-class="fix('addr')")
              +valid-label("orderform","addr", "寄送地址", "地址")
              input.form-control(type="text",placeholder="例如：台北市士林區福港街 12 號",
                ng-disabled="!want || state!=0",name="addr",ng-model="addr",required,ng-minlength="5")
            .row
              .col-sm-6: .form-group(ng-class="fix('phone')")
                +valid-label("orderform","phone", "聯絡電話", "電話")
                input.form-control(type="text",placeholder="例如： 0912312412 ( 於送貨時聯絡用 )",
                  ng-disabled="!want || state!=0",name="phone",ng-model="phone",required,ng-minlength="7",ng-pattern="/[0-9-() ]/")
              .col-sm-6: .form-group(ng-class="fix('email')")
                +valid-label("orderform","email", "電子郵件信箱", "電子郵件信箱")
                input.form-control(type="email",placeholder="例如：john@mail.tw ( 訂單會同時以信件寄給您 )",
                  ng-disabled="!want || state!=0",name="email",ng-model="email",required)
              //-.col-sm-4(ng-show="!user"): .form-group(ng-class="fix('password')")
                +valid-label("orderform","password","密碼", "密碼")
                input.form-control(type="password",placeholder="用於確認或修改訂單",
                  ng-disabled="!want || state!=0",name="password",ng-model="password",required)
              //-.col-sm-4(ng-show="user"): .form-group
                label &nbsp;
                .btn.btn-warning.form-control(ng-disabled="state!=0",ng-click="logout()") 我要用另外一組電子郵件
            //-.row
              .col-sm-12
                .form-group
                  label 付款方式
                  .radio
                    input(type="radio",name="payment",ng-model="payment",value="1")
                    label 貨到付款
                  .radio
                    input(type="radio",name="payment",ng-model="payment",value="2")
                    label 
                      | 超商取貨
                      |  ( 
                      a 選擇門市 ...
                      |  )

            br

            #order-detail.barblock.green
              h4
                i.glyphicon.glyphicon-th-list
                span  訂單明細
              .desc
                span(ng-show="priceTotal()")  您所選購的商品為
                span(ng-show="!priceTotal()")  您尚未選購任何背包
                ul(ng-show="priceTotal()")
                  li(ng-show="count.red") 紅色背包 {{count.red}} 個 x {{price.red}} 元
                  li(ng-show="count.green") 綠色背包 {{count.green}} 個 x {{price.green}} 元
                  li(ng-show="count.cyan") 藍色背包 {{count.cyan}} 個 x {{price.cyan}} 元
                  li(ng-show="count.purple") 紫色背包 {{count.purple}} 個 x {{price.purple}} 元
                  li(ng-show="count.magenta") 紫紅色背包 {{count.magenta}} 個 x {{price.magenta}} 元
                  li(ng-show="count.black") 黑色背包 {{count.black}} 個 x {{price.black}} 元
                  li 運費 50 元

              .total(ng-show="priceTotal()")
                i.glyphicon.glyphicon-tag
                |  此筆訂單的總金額為：
                span.red {{priceTotal()}} 
                |  元

            br
            h4
              i.glyphicon.glyphicon-credit-card
              |  最後，選擇貨物送達時間
            .row
              .col-sm-6
                button.btn.btn-danger.btn-block.btn-lg(type="submit",ng-disabled="!priceTotal() || !want || state!=0",ng-click="submit(1)")
                  | 貨到付款
                  | - 白天 09:00 ~ 18:00
                br
              .col-sm-6
                button.btn.btn-danger.btn-block.btn-lg(type="submit",ng-disabled="!priceTotal() || !want || state!=0",ng-click="submit(2)")
                  | 貨到付款
                  | - 晚上 18:00 ~ 21:00
                //- button.btn.btn-danger.btn-block.btn-lg(type="submit",ng-disabled="!priceTotal() || !want || state!=0",ng-click="submit(0)") ATM、超商付款或信用卡
                //- | * 若選此項，將連至歐付寶繼續下一步
            br
            #order-complete-anchor
            #ssl
              img(src="img/SSL.png",style="width:64px")
              div(style="display:inline-block;vertical-align:middle")
                | 我們使用 SSL 連線，
                br
                | 保障您的資料安全
            .text-danger(ng-show="fix('name') || fix('addr') || fix('email') || fix('password') || fix('phone')")
              | 您所填的資料有點問題，請修正後重新送出
            #order-complete(ng-show="state==2")
              h3
                i.glyphicon.glyphicon-ok
                |  訂購完成！
              p 感謝您的訂購！我們同時寄送了一封訂購明細至您所提供的信箱，以便您確認訂購內容。
              //-button.btn.btn-default(type="submit",ng-disabled="true",ng-click="submit()",ng-show="state==2") 訂購完成!
              button.btn.btn-success(type="submit",ng-click="clearForm()") 想要再多買幾個嗎？按我追加
            br
            br
            p * 商品訂購後將於 5 ~ 7 天內出貨

        //-form#allpayform(action="http://payment-stage.allpay.com.tw/AioHelper/GenCheckMacValue",method="POST")
        form#allpayform(action="https://payment.allpay.com.tw/Cashier/AioCheckOut",method="POST")
          input.form-control(type="hidden",name="MerchantID",ng-value="allPayData.MerchantID")
          input.form-control(type="hidden",name="MerchantTradeNo",ng-value="allPayData.MerchantTradeNo")
          input.form-control(type="hidden",name="MerchantTradeDate",ng-value="allPayData.MerchantTradeDate")
          input.form-control(type="hidden",name="PaymentType",ng-value="allPayData.PaymentType")
          input.form-control(type="hidden",name="TotalAmount",ng-value="allPayData.TotalAmount")
          input.form-control(type="hidden",name="TradeDesc",ng-value="allPayData.TradeDesc")
          input.form-control(type="hidden",name="ItemName",ng-value="allPayData.ItemName")
          input.form-control(type="hidden",name="ReturnURL",ng-value="allPayData.ReturnURL")
          //-input.form-control(type="hidden",name="OrderResultURL",ng-value="allPayData.OrderResultURL")
          input.form-control(type="hidden",name="ClientBackURL",ng-value="allPayData.ClientBackURL")
          input.form-control(type="hidden",name="ChoosePayment",ng-value="allPayData.ChoosePayment")
          input.form-control(type="hidden",name="PaymentInfoURL",ng-value="allPayData.PaymentInfoURL")
          input.form-control(type="hidden",name="IgnorePayment",ng-value="allPayData.IgnorePayment")
          input.form-control(type="hidden",name="CheckMacValue",ng-value="allPayData.CheckMacValue")
          //-input.btn.btn-danger(type="submit",value="submit")

    br.clear
    br
    hr
    br
    br
    #about
      h2
        img(src="/img/logo/icon-black.png")
        |  聯絡我們
      p
        | 有任何訂購或商品上的問題，歡迎您寫信與我們聯絡，來信請寄至客服信箱 
        a(href="mailto:contact@fernwing.com") contact@fernwing.com
        |  ，我們會在 48 小時之內回覆您。
      br
      br
    //-#about: .ib
      h2 
        img(src="/img/logo/icon-black.png")
        |  關於我們
      p 喜愛戶外運動的我們，常在陽光灑落的杉林中穿梭、嗅著山間青色的味道，輕盈的步伐跳躍在佈滿星蕨的泥土小徑上，露水沾濕了褲管，卻洗去了沈重的形象。我們常思考著，背包不應是旅行的負擔，而應該是生長在旅者背後的一對翅膀，帶著我們翩翩躍於旅人的行跡間。
      br 
      p 大多數的登山攻頂包為了輕量化而減去了機能，就像剪去羽毛的翅膀一般，而蕨之翼拒絕了這樣的妥協。隱喻著翅膀的蕨，拓印在每個蕨之翼的背包上，彷彿讓每位使用者都長出了翅膀，於各自的旅程間敖翔。
      br 
      p 此外，我們也注意到，時尚與機能之間，並不存在一條明顯的分界線；當回到文明社會之時，蕨之翼簡單清新的外觀，就像鳥兒收起了雙翼般，伴隨你徘徊在熱鬧繁華的街道之間。
      br
      p 你不再需要很多個背包了。你只需要一對翅膀。
      br
      div(style="width:60%;margin:auto"): a.btn.btn-danger.btn-block.btn-lg(href="/#order-info") 現在就訂購
      br
      br

    .modal.fade#orderlist(role="dialog",aria-labelledby="orderlist",aria-hidden="true")
      .modal-dialog
        .modal-content
          .modal-header
            button.close(type="button",data-dismiss="modal" aria-hidden="true") &times;
            h4.modal-title 訂單列表
          .modal-body
            table
              tr
                th 姓名
                th 地址
                th 電子郵件
                th 電話
              tr(ng-repeat="(k,v) in orders.pending") 
                td {{v[0]}}
                td {{v[1]}}
                td {{v[2]}}
                td {{v[3]}}
          .modal-footer
            button.btn.btn-default(type="button",data-dismiss="modal") 關閉
